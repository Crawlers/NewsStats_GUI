# select random date in a rangeSELECT DATE( TIMESTAMPADD( SECOND , FLOOR( RAND( ) * TIMESTAMPDIFF( SECOND ,  '2014-01-01',  '2014-12-31' ) ) ,  '2014-01-01' ) )# update false dates to 2014 dates (only for testing)UPDATE `crime_entity_group` SET `crime_date`=(SELECT DATE( TIMESTAMPADD( SECOND , FLOOR( RAND( ) * TIMESTAMPDIFF( SECOND ,  '2014-01-01',  '2014-12-31' ) ) ,  '2014-01-01' ) )) WHERE crime_date < '2012-01-01' OR crime_date > '2014-12-31'# update random dates to 2014 dates (only for testing)UPDATE crime_entity_group set crime_date = (SELECT DATE( TIMESTAMPADD( SECOND , FLOOR( RAND( ) * TIMESTAMPDIFF( SECOND ,  '2014-01-01',  '2014-12-31' ) ) ,  '2014-01-01' ) )) where id in (SELECT * FROM (SELECT id  FROM crime_entity_group ORDER BY RAND() LIMIT 0,1000) as t)# create tableCREATE TABLE IF NOT EXISTS `newsstat` (  `crime_type` varchar(20) NOT NULL,  `crime_district` varchar(20) NOT NULL,  `crime_date` date NOT NULL,  `crime_year` varchar(20) NOT NULL,  `crime_yearquarter` varchar(20) NOT NULL,  `crime_count` int(11) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=latin1;# update district field in crime_entity_groupUPDATE crime_entity_group SET district = ( SELECT districtFROM location_district_mapperWHERE location_district_mapper.location = crime_entity_group.location )# selection from crime_entity_group (district should be updated) and insert into tableINSERT INTO newsstat (SELECT crime_type,district, crime_date, YEAR (crime_date), CONCAT(YEAR (crime_date), ' - ', QUARTER(crime_date)), count(id) FROM crime_entity_group GROUP BY crime_type, district, crime_date ORDER BY YEAR ('crime_date'))# change null to other UPDATE `newsstat` SET `crime_type`='Other' where crime_type = ''